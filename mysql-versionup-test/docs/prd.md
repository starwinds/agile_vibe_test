# PRD: MySQL 8.0 vs 8.4 버전 비교 테스트 자동화

## 1. 개요 (Overview)
본 문서는 MySQL 8.0.42와 8.4.7 버전 간의 주요 차이점을 검증하기 위한 테스트베드 구축 및 자동화 프로젝트의 요구사항을 정의합니다. Docker Compose를 사용하여 두 버전의 MySQL 환경을 구성하고, Python과 pytest를 이용해 기능, 동작, 기본 파라미터의 차이를 비교 분석하는 테스트 스크립트를 개발합니다.

## 2. 목표 (Goals)
- **정확한 차이점 식별:** MySQL 8.0.42와 8.4.7 간의 스키마(DDL), 인증, 기본 파라미터, 성능 등 주요 항목의 차이점을 실제 테스트를 통해 명확히 식별하고 문서화합니다.
- **자동화된 검증 환경 구축:** 향후 다른 MySQL 버전 비교에도 재사용할 수 있는 자동화된 테스트 환경을 구축하여 반복적인 검증 작업을 효율화합니다.
- **기술적 의사결정 지원:** DBaaS(Database as a Service) 팀이 차기 MySQL 버전으로의 업그레이드 여부를 결정하는 데 필요한 구체적이고 신뢰성 있는 기술 검토 자료를 제공합니다.

## 3. 사용자 (Users)
- **DBaaS 제공팀 엔지니어:** MySQL 업그레이드에 따른 기술적 영향을 분석하고 사전 검증을 수행하는 담당자.
- **기술 의사결정권자:** 테스트 결과를 바탕으로 서비스 안정성 및 호환성을 고려하여 업그레이드 전략을 수립하는 리더.

## 4. 사용자 시나리오 (User Scenarios)
- **시나리오 1: 버전 간 호환성 테스트 실행**
  - DBaaS 엔지니어는 새로 구축된 테스트 환경에서 `pytest` 명령어를 실행하여 MySQL 8.0과 8.4 간의 자동화된 비교 테스트를 수행합니다.
  - 테스트 실행 후, 터미널 출력과 생성된 리포트(`test_results.json`, `mysql_version_diff_test_report.md`)를 통해 각 테스트 케이스의 성공/실패 여부와 상세 결과를 확인합니다.
- **시나리오 2: 특정 기능 차이점 재현**
  - 엔지니어는 FK 제약 조건, 인증 플러그인 등 특정 기능의 버전 간 동작 차이가 궁금할 때, 관련 테스트 코드(`test_fk.py`, `test_auth.py` 등)를 직접 실행하거나 수정하여 차이점을 재현하고 심층 분석합니다.
- **시나리오 3: 테스트 결과 기반 업그레이드 영향 분석**
  - 기술 의사결정권자는 자동 생성된 `mysql_version_diff_test_report.md` 요약 보고서를 통해 버전 간 주요 차이점과 운영 환경에 미칠 수 있는 영향을 한눈에 파악하고, 이를 업그레이드 계획 수립의 근거 자료로 활용합니다.

## 5. 기능 요구사항 (Functional Requirements)
### 5.1. 테스트 실행 환경
- **FR-1:** Docker Compose를 사용하여 MySQL 8.0.42와 8.4.7 컨테이너를 동시에 실행할 수 있어야 합니다.
- **FR-2:** 각 MySQL 인스턴스는 서로 다른 포트로 서비스되어야 하며, 외부에서 접근 가능해야 합니다.
- **FR-3:** 각 버전별로 독립적인 설정 파일(`my.cnf`)과 초기화 스크립트(`init.sql`)를 사용하여 환경을 구성할 수 있어야 합니다.

### 5.2. 비교 테스트 스크립트
- **FR-4 (스키마/DDL):** Foreign Key 제약 조건, PK 없는 테이블 정책, Collation, 신규 예약어 등 DDL 관련 동작 차이를 검증하는 테스트 케이스를 구현해야 합니다.
- **FR-5 (인증):** `mysql_native_password`와 `caching_sha2_password` 인증 플러그인 기반 계정의 접속 가능 여부를 버전별로 테스트해야 합니다.
- **FR-6 (기본 파라미터):** `binlog_expire_logs_seconds`, `innodb_flush_neighbors` 등 지정된 주요 시스템 변수 값을 두 버전에서 수집하고 비교할 수 있어야 합니다.
- **FR-7 (성능):** 간단한 Insert TPS 및 Select Latency를 측정하여 버전 간 상대적 성능 경향을 비교하는 테스트를 포함해야 합니다.

### 5.3. 테스트 결과 리포팅
- **FR-8:** 모든 테스트 결과를 담은 `test_results.json` 파일을 생성해야 합니다. (테스트명, 상태, 에러 정보 등 포함)
- **FR-9:** 주요 차이점을 표 형태로 요약하고, 실패 케이스 재현 SQL 및 운영 영향도 코멘트를 포함한 `mysql_version_diff_test_report.md` 마크다운 보고서를 생성해야 합니다.

## 6. 비기능 요구사항 (Non-functional Requirements)
- **NFR-1 (개발 환경):** Windows + WSL2 (Ubuntu) 환경에서 모든 설정과 테스트가 정상적으로 동작해야 합니다.
- **NFR-2 (기술 스택):** 테스트 자동화는 Python과 `pytest` 프레임워크를 기반으로 작성해야 합니다.
- **NFR-3 (의존성):** 외부 상용 도구 없이 오픈소스 라이브러리 및 기본 패키지만을 사용해야 합니다.
- **NFR-4 (재현성):** 로컬 개발 환경에서 누구나 쉽게 테스트 환경을 구축하고 결과를 재현할 수 있어야 합니다.
