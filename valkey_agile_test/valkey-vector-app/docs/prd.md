# Product Requirements Document (PRD) for Valkey VectorSearch App

## 1. 프로젝트 개요
이 프로젝트는 Valkey의 VectorSearch 기능을 활용하여 Python 애플리케이션에서 문장 임베딩 데이터를 저장하고, 코사인 유사도 기반의 벡터 검색을 수행하는 샘플 앱을 구축하는 것을 목표로 합니다. Agile + TDD 환경에서 개발을 진행합니다.

## 2. 목표
- Valkey VectorSearch를 이용한 효율적인 벡터 데이터 저장 및 관리.
- 문장 임베딩 생성 및 저장 기능 구현.
- 코사인 유사도 기반의 벡터 검색 기능 구현.
- 안정적인 Python 애플리케이션 개발 및 테스트 환경 구축.

## 3. 사용자 시나리오
- **데이터 과학자:** 새로운 텍스트 데이터를 입력하면, 해당 텍스트의 임베딩이 생성되어 Valkey에 저장됩니다.
- **개발자:** 특정 쿼리 텍스트에 대해 유사한 임베딩을 가진 문서를 Valkey에서 검색하고 결과를 확인합니다.
- **테스터:** 애플리케이션의 임베딩 생성 및 벡터 검색 기능이 올바르게 작동하는지 검증합니다.

## 4. 기능 정의

### 4.1. 핵심 기능
- **문장 임베딩 생성:** `sentence-transformers` 라이브러리를 사용하여 텍스트로부터 384차원 임베딩 벡터를 생성합니다.
- **Valkey 연결 및 인덱스 관리:** Valkey 서버에 연결하고, 벡터 검색을 위한 인덱스(`doc_index`)를 생성 및 관리합니다.
- **문서 저장:** 텍스트 내용과 해당 임베딩 벡터를 Valkey에 문서 형태로 저장합니다.
- **벡터 검색:** 주어진 쿼리 벡터와 코사인 유사도 기반으로 가장 유사한 문서를 검색합니다.

### 4.2. 기술 스택
- **데이터베이스:** Valkey (VectorSearch 모듈 포함)
- **언어:** Python 3.x
- **라이브러리:** `redis`, `sentence-transformers`, `numpy`, `pytest`, `flask` (향후 웹 인터페이스 구현 시)
- **컨테이너:** Docker

## 5. 비고
- 현재까지 Valkey Docker 컨테이너 설정, Python 환경 구축, `db_utils.py` 및 `embedding.py` 스켈레톤 코드 작성 및 테스트 완료.
- `TEXT` 필드 타입 대신 `TAG` 필드 타입을 사용하여 인덱스 생성 문제를 해결함.
- `sort_by` 및 `dialect` 인자 관련 `redis-py` 라이브러리 호환성 문제 해결.
