# 제품 백로그 (Product Backlog)

이 문서는 Redis/Valkey 호환성 테스트 스위트 개발을 위한 Epic, 사용자 스토리(User Story), 작업(Task)을 정의합니다.

---

## Epic 1: 테스트 환경 구축

> **설명:** Redis와 Valkey를 대상으로 동일한 테스트를 실행할 수 있는 기본 환경을 설정합니다.

### 사용자 스토리 1.1: 개발자로서, Docker를 사용하여 테스트할 데이터베이스를 쉽게 실행하고 싶다.
- **Task 1.1.1:** `docker-compose.yml` 파일 작성 (Redis 7.2.6, Valkey 9.0 서비스 정의)
- **Task 1.1.2:** 각 서비스의 포트 매핑 설정 (Redis: 6379, Valkey: 6380)
- **Task 1.1.3:** README에 Docker 실행 방법 문서화

### 사용자 스토리 1.2: 개발자로서, Python 테스트 스크립트 실행에 필요한 라이브러리를 쉽게 설치하고 싶다.
- **Task 1.2.1:** `requirements.txt` 파일 생성
- **Task 1.2.2:** `redis-py`, `rich` 등 필수 패키지 명시

---

## Epic 2: 핵심 기능 테스트 시나리오 개발

> **설명:** Redis와 Valkey의 핵심 기능 동작을 비교하기 위한 테스트 시나리오들을 개발합니다.

### 사용자 스토리 2.1: 개발자로서, 기본적인 CRUD 명령어(SET, GET, DEL 등)의 호환성을 검증하고 싶다.
- **Task 2.1.1:** `basic_crud.py` 시나리오 파일 생성
- **Task 2.1.2:** SET, GET, EXISTS, EXPIRE, TTL, DEL 명령어 테스트 로직 구현

### 사용자 스토리 2.2: 개발자로서, 주요 데이터 구조(Hash, List, Set, Sorted Set)의 동작 일관성을 확인하고 싶다.
- **Task 2.2.1:** `data_structures.py` 시나리오 파일 생성
- **Task 2.2.2:** HSET/HGET, LPUSH/LPOP, SADD/SMEMBERS, ZADD/ZRANGE 등 테스트 로직 구현

### 사용자 스토리 2.3: 개발자로서, 키 스페이스 스캔 명령어의 호환성을 검증하고 싶다.
- **Task 2.3.1:** `scan_and_iter.py` 시나리오 파일 생성
- **Task 2.3.2:** SCAN, HSCAN, ZSCAN 반복 동작 및 결과 완전성 테스트

### 사용자 스토리 2.4: 개발자로서, Pub/Sub 기능이 동일하게 동작하는지 확인하고 싶다.
- **Task 2.4.1:** `pubsub.py` 시나리오 파일 생성
- **Task 2.4.2:** PUBLISH 후 SUBSCRIBE 메시지 수신 검증 로직 구현

### 사용자 스토리 2.5: 개발자로서, Lua 스크립트와 트랜잭션 처리의 일관성을 검증하고 싶다.
- **Task 2.5.1:** `lua_and_tx.py` 시나리오 파일 생성
- **Task 2.5.2:** EVAL/EVALSHA 및 MULTI/EXEC 명령어 테스트 로직 구현

---

## Epic 3: 테스트 실행 및 결과 보고 자동화

> **설명:** 모든 테스트 시나리오를 자동으로 실행하고, 그 결과를 명확하게 비교하여 리포트하는 시스템을 구축합니다.

### 사용자 스토리 3.1: 개발자로서, 단일 명령어로 모든 테스트를 실행하고 그 결과를 터미널에서 즉시 확인하고 싶다.
- **Task 3.1.1:** `test_runner.py` 메인 스크립트 개발
- **Task 3.1.2:** `scenarios` 폴더 내의 모든 테스트를 동적으로 로드하는 기능 구현
- **Task 3.1.3:** `config.py`에서 Redis/Valkey 접속 정보 관리
- **Task 3.1.4:** `rich` 라이브러리를 사용하여 결과를 테이블 형식으로 출력

### 사용자 스토리 3.2: 개발자로서, 테스트 결과를 파일로 저장하여 상세 분석 및 이력 관리하고 싶다.
- **Task 3.2.1:** 각 타겟(Redis/Valkey)별 결과를 JSON 파일로 저장하는 기능 구현
- **Task 3.2.2:** 두 결과의 차이점을 비교하여 별도의 테이블로 요약 출력하는 기능 구현

### 사용자 스토리 3.3: 개발자로서, 프로젝트의 목적과 사용법을 쉽게 이해할 수 있는 문서가 필요하다.
- **Task 3.3.1:** `README.md` 파일 작성
- **Task 3.3.2:** 프로젝트 목적, 요구사항, 실행 순서, 결과 해석 방법 명시
- **Task 3.3.3:** 새로운 테스트 시나리오 추가 방법 가이드 작성

---

## Epic 4: 고급 호환성 테스트 시나리오 확장 (Sprint 2)

> **설명:** 메모리 관리, 대용량 데이터 처리 등 미세한 동작 차이를 검증하기 위한 고급 테스트 시나리오를 추가합니다.

### 사용자 스토리 4.1: 개발자로서, maxmemory 도달 시 발생하는 Eviction 정책의 동작 차이를 비교하고 싶다.
- **Task 4.1.1:** `memory_eviction.py` 시나리오 파일 생성
- **Task 4.1.2:** `maxmemory` 및 `allkeys-lru` 정책 설정 로직 구현
- **Task 4.1.3:** 메모리 압박을 위한 대량 키 생성 및 삭제 후 키 개수, 메모리 사용량 등 메트릭 수집 로직 구현
- **Task 4.1.4:** 테스트 전후 `maxmemory` 설정을 원래대로 복원하는 로직 추가

### 사용자 스토리 4.2: 개발자로서, 다양한 크기의 Payload 처리 시 발생하는 성능(latency) 및 메모리 사용량 차이를 분석하고 싶다.
- **Task 4.2.1:** `large_payloads.py` 시나리오 파일 생성
- **Task 4.2.2:** 1KB, 32KB, 256KB, 1MB, 5MB 등 다양한 크기의 Payload 생성 로직 구현
- **Task 4.2.3:** 각 Payload 크기별 SET/GET Latency 및 메모리 사용량 측정 로직 구현
- **Task 4.2.4:** 측정 결과를 `metrics` 딕셔너리 구조로 반환

### 사용자 스토리 4.3: 개발자로서, Sprint 1에서 실패했던 Pub/Sub 테스트를 수정하고 싶다.
- **Task 4.3.1:** `pubsub.py`의 메시지 수신 로직 디버깅
- **Task 4.3.2:** `time.sleep()` 대신 `pubsub.get_message()`의 timeout을 활용하여 안정성 개선

### 사용자 스토리 4.4: 개발자로서, 새로운 시나리오가 자동으로 실행되고 문서도 업데이트되길 원한다.
- **Task 4.4.1:** `test_runner.py`가 새로운 시나리오를 자동으로 발견하여 실행하도록 보장 (기존 기능 확인)
- **Task 4.4.2:** `README.md`에 Sprint 2에서 추가된 시나리오에 대한 설명 추가
